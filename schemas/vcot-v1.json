{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/Dharma-Technologies/memstamp/blob/main/schemas/vcot-v1.json",
  "title": "VCOT Event Schema v0.1",
  "description": "Verifiable Chain of Thought (VCOT) event schema for AI agent audit trails",
  "type": "object",
  "required": [
    "version",
    "event_id",
    "event_type",
    "timestamp",
    "agent_id",
    "content_hash",
    "previous_hash",
    "framework",
    "signature"
  ],
  "properties": {
    "version": {
      "type": "string",
      "const": "vcot/0.1",
      "description": "VCOT schema version"
    },
    "event_id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique event identifier (UUIDv7 recommended for time-ordering)"
    },
    "event_type": {
      "type": "string",
      "enum": [
        "decision",
        "tool_call",
        "tool_result",
        "memory_write",
        "memory_read",
        "external_action",
        "state_change",
        "observation",
        "custom"
      ],
      "description": "Type of agent event"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp in UTC"
    },
    "agent_id": {
      "type": "string",
      "minLength": 1,
      "maxLength": 256,
      "description": "Agent identifier (opaque, agent-chosen)"
    },
    "content_hash": {
      "type": "string",
      "pattern": "^sha256:[a-f0-9]{64}$",
      "description": "SHA-256 hash of canonical JSON content"
    },
    "previous_hash": {
      "type": "string",
      "pattern": "^sha256:[a-f0-9]{64}$",
      "description": "Hash chain link to previous event (genesis = sha256:0000...)"
    },
    "framework": {
      "type": "string",
      "minLength": 1,
      "maxLength": 64,
      "description": "Agent framework identifier (e.g., 'openclaw/2026.2', 'langchain/0.3')"
    },
    "signature": {
      "type": "string",
      "minLength": 1,
      "description": "Ed25519 signature of event hash, hex-encoded"
    },
    "metadata": {
      "type": "object",
      "description": "Optional additional metadata",
      "additionalProperties": true
    }
  },
  "additionalProperties": false
}
